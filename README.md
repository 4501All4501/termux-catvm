# termux-catvm

CatVM is a lightweight, Termux-focused virtual machine workflow that aims to boot real guest operating systems from disk images without the traditional full-system QEMU stack.

## Project overview

CatVM is designed for Android + Termux environments where you want practical VM-style boot workflows but with minimal overhead and a mobile-friendly setup.

### What CatVM is

- A shell-driven toolchain (`catvm.sh` and helper scripts) for preparing and booting guest images.
- Focused on quick local experimentation from Termux instead of a full desktop virtualization management layer.
- Intended for users who are comfortable with Linux boot concepts (kernel, initrd, rootfs, BIOS/bootloader selection).

### What “no qemu but real boot” means technically

In this project context, “no qemu but real boot” means:

- You are **not** launching a full software-emulated machine via `qemu-system-*`.
- Instead, CatVM drives a boot flow that uses available host/kernel features and image boot components directly.
- Guest boot artifacts (kernel, initrd, bootloader/BIOS config, disk image state) are treated as real boot inputs rather than being hidden behind QEMU machine emulation.
- This gives a lighter and often faster startup path in constrained Termux environments, with trade-offs in hardware emulation breadth and compatibility.

> If you specifically require broad virtual hardware emulation (PCI devices, rich machine models, nested virtualization scenarios), a classic QEMU/KVM setup may still be more appropriate.

## Prerequisites and environment assumptions

CatVM assumes a relatively advanced Termux setup.

### Required baseline

- Android device with sufficient free storage (guest images can grow quickly).
- Recent Termux installation.
- POSIX shell support (`bash` recommended).
- Execute permission on project scripts.

### Recommended Termux packages

Install/verify commonly required tooling:

```bash
pkg update && pkg upgrade
pkg install bash coreutils util-linux e2fsprogs dosfstools parted fdisk grep sed gawk
```

Depending on your workflow, you may also need:

```bash
pkg install wget curl xz-utils tar
```

### Kernel/features assumptions

- Device kernel must expose the features CatVM relies on for mounting/managing images and boot artifacts.
- Loop/mount-style operations (if used by your flow) must be permitted by your environment.
- SELinux/device restrictions may limit low-level operations on some Android builds.

### Permissions and storage assumptions

- You can run scripts from your project directory.
- You have read/write access to the storage path where VM images and state files are kept.
- If using shared storage paths, ensure Termux storage permission has been granted (`termux-setup-storage`).

## Quick start

From the repository root:

```bash
chmod +x catvm.sh catvm-change-bios
./catvm.sh
./catvm-change-bios
```

Typical flow:

1. Make scripts executable (`chmod +x`).
2. Run `./catvm.sh` to initialize/start the VM boot workflow.
3. Run `./catvm-change-bios` when you need to switch or update BIOS/boot profile settings.

If a script is missing, verify you are in the correct directory and that the repository checkout is complete.

## Command reference

| Command | Syntax | Arguments | Example | Expected output / state change |
|---|---|---|---|---|
| Main launcher | `./catvm.sh [options]` | Optional flags if implemented by your local script version (see inline `--help` or script header). | `./catvm.sh` | Starts/continues VM boot process, prepares or reuses VM state files, and prints boot progress/status messages. |
| BIOS/profile switcher | `./catvm-change-bios [profile-or-option]` | Profile name or script-defined option depending on implementation. | `./catvm-change-bios` | Updates BIOS/boot profile configuration used by subsequent `catvm.sh` runs; prints selected profile/status. |
| Script permissions setup | `chmod +x catvm.sh catvm-change-bios` | Script paths. | `chmod +x catvm.sh catvm-change-bios` | Makes scripts executable so they can be run directly. |

### Discovering exact options in your local copy

Because script versions may differ, use:

```bash
./catvm.sh --help
./catvm-change-bios --help
```

If help flags are not implemented, open the script and inspect usage comments near the top.

## Persistence model

CatVM persists VM state via files on your Termux-accessible filesystem.

### Typical persisted artifacts

- Guest disk image(s).
- Boot artifacts (kernel/initrd/boot config), depending on how your scripts are configured.
- BIOS/profile selection or metadata state (if maintained by `catvm-change-bios`).
- Logs/cache files generated by the scripts.

### Where state is stored

State is generally stored in one of the following locations (depending on script configuration):

- Current project directory.
- A subdirectory created by the scripts (for example: `./vm/`, `./images/`, `./state/`).
- A user-designated path defined in script variables or environment variables.

To confirm your actual state path, inspect path variables in `catvm.sh` and `catvm-change-bios`.

### Limitations

- Moving/deleting state files can make existing VM instances unbootable.
- Disk images may be architecture- and profile-specific.
- Interrupted writes (battery kill, force-stop, storage full) can corrupt images.
- Android filesystem restrictions may block specific mount/loop workflows on some devices.

## Troubleshooting

### `Permission denied` when running scripts

- Ensure scripts are executable:

```bash
chmod +x catvm.sh catvm-change-bios
```

- Ensure you are running from a writable, executable path in Termux.

### Script not found (`./catvm.sh: No such file or directory`)

- Confirm you are in the repository root.
- Confirm files exist and checkout is complete.
- Run `pwd` and `ls` to verify paths.

### Boot fails immediately

- Re-check selected BIOS/profile via `./catvm-change-bios`.
- Verify image files exist and are readable.
- Confirm required packages are installed.
- Check script output/logs for missing tool errors.

### Storage-related failures (`No space left on device`)

- Free space on internal/shared storage.
- Remove stale images/snapshots/logs.
- Re-run after cleanup.

### Mount/loop/low-level operation errors

- Device kernel or Android policy may not permit the required operation.
- Try a different device/kernel build or adjust workflow to avoid restricted features.

### Inconsistent state after interruption

- If possible, restore from backups/snapshots.
- Recreate affected image/state files.
- Keep periodic copies of known-good state for faster recovery.

## Notes

- CatVM behavior may vary by script version; always trust your local script source of truth for flags and path defaults.
- For repeatable setups, keep a small checklist: package versions, BIOS/profile choice, image location, and free-space baseline.
